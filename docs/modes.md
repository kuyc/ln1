1. Назначение документа

Этот документ формально описывает режимы работы бота и является:

обязательным для всех агентов;

источником истины для Workflow Engine;

защитой от «разного понимания» Semi-Auto и Auto.

Если поведение не описано здесь — оно запрещено.

2. Общие определения
Администратор

Пользователь Telegram, обладающий правами:

запускать режимы;

подтверждать критические действия;

останавливать автоматизацию.

Товар

Единица продажи на Playerok, созданная и управляемая ботом.

Workflow

Последовательность шагов, управляемая Workflow Engine, которая:

может останавливаться;

может ожидать подтверждения;

может повторяться (только в Auto).

3. Полуавтономный режим (Semi-Auto)
3.1 Назначение

Используется, когда:

администратор хочет полный контроль;

требуется разовое создание товара;

идёт тест категории или шаблона.

3.2 Триггер

Администратор нажимает кнопку «Создать товар (Semi-Auto)».

3.3 Workflow (последовательность)
START
 ↓
Сбор данных по категории
 ↓
AI: генерация названия / описания / комментария
 ↓
AI: генерация превью
 ↓
Ожидание подтверждения администратора
 ↓
(Если отказ → STOP)
 ↓
Публикация товара в Playerok
 ↓
Ожидание покупки
 ↓
Покупка произошла
 ↓
Отправка шаблонных сообщений покупателю
 ↓
Подтверждение заказа
 ↓
STOP

3.4 Ключевые свойства Semi-Auto

❌ нет автоматического перевыставления товара;

❌ нет автоматической смены режима;

❌ нет повторных публикаций;

✅ один запуск = один товар;

✅ каждое критическое действие подтверждается администратором.

3.5 Ограничения

Workflow не может самопроизвольно продолжиться;

Любая ошибка → STOP + уведомление админа;

Цена после публикации:

может изменяться только с разрешения администратора.

4. Автономный режим (Auto)
4.1 Назначение

Используется, когда:

категория протестирована;

шаблоны подтверждены;

требуется масштабирование продаж.

4.2 Триггер

Администратор нажимает кнопку «Включить автономный режим».

4.3 Workflow (циклический)
START
 ↓
Сбор данных по категории
 ↓
AI: генерация / обновление контента
 ↓
AI / Pricing Engine: расчёт цены
 ↓
Ожидание подтверждения администратора (ТОЛЬКО первый запуск)
 ↓
Публикация товара
 ↓
Ожидание покупки
 ↓
Покупка произошла
 ↓
Отправка сообщений покупателю
 ↓
Подтверждение заказа
 ↓
Обновление статистики и цены
 ↓
ПОВТОР (новая публикация)

4.4 Ключевые свойства Auto

✅ автоматическое перевыставление товара;

✅ динамическая цена;

✅ самообучение на данных;

❌ нет запроса подтверждения на каждом цикле;

❌ нет выхода из режима без команды администратора.

4.5 Ограничения Auto

Если произошла ошибка:

цикл останавливается;

администратор уведомляется;

автоматическое восстановление запрещено.

Если цена выходит за допустимые пределы:

требуется ручное подтверждение.

5. Управление ценой в режимах
Действие	Semi-Auto	Auto
Стартовая цена	AI / БД	AI / БД
Авто-изменение	❌	✅
Падение цены	❌	✅
Рост цены	❌	✅
Лимиты	Admin	Admin
6. Переключение режимов
Разрешено:

Semi-Auto → Auto (только вручную)

Auto → STOP (только вручную)

Запрещено:

Auto → Semi-Auto автоматически

Автопереключение без команды администратора

7. Состояния Workflow (State Machine)
IDLE
 ├─> SEMI_RUNNING
 │    └─> STOP
 │
 └─> AUTO_RUNNING
      └─> ERROR_STOP

8. Обработка ошибок (для обоих режимов)

При любой ошибке:

Workflow останавливается;

состояние сохраняется;

администратор получает уведомление;

требуется ручное вмешательство.

9. Запрещённые действия (жёстко)

AI не может:

включать режимы;

переключать режимы;

продолжать Workflow после ошибки;

игнорировать подтверждение администратора.

10. Финальное правило

Режим — это контракт.
Контракт не интерпретируется, он исполняется.
